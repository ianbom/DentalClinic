import{j as e,r as a,d as f}from"./app-Ddfl5t9z.js";import{S as te,B as ae,a as le}from"./ServiceSelection-DIiRomDA.js";import{u as ne,B as re}from"./BookingContext-DxnQIfP0.js";import{A as de}from"./AdminLayout-DM3a-L7e.js";import"./AdminSidebar-wHxo9R0c.js";const ce=[{value:"cash",label:"Tunai"},{value:"transfer",label:"Transfer Bank"},{value:"qris",label:"QRIS"},{value:"debit",label:"Kartu Debit"},{value:"credit",label:"Kartu Kredit"}],ie=[{value:"patient",label:"Pasien"},{value:"admin",label:"Admin"},{value:"system",label:"System"}];function oe({booking:t,allDoctors:I,doctor:c,availableSlots:h,selectedDoctorId:T}){const{bookingData:l,setBookingData:b,resetBookingData:g}=ne(),[i,z]=a.useState(T),[j,R]=a.useState(t.service),[N,y]=a.useState(!1),[v,M]=a.useState(!1),[r,K]=a.useState(t.patient.name),[o,E]=a.useState(t.patient.nik),[m,W]=a.useState(t.patient.phone),[w,L]=a.useState(t.patient.birthdate||""),[S,q]=a.useState(t.patient.address||""),[_,J]=a.useState(t.patient.gender||""),[C,$]=a.useState(t.patient.medical_records||""),[x,O]=a.useState(t.status),[n,F]=a.useState(t.payment?.amount?.toString()||""),[P,G]=a.useState(t.payment?.payment_method||"cash"),[k,Q]=a.useState(t.payment?.note||""),[u,V]=a.useState(t.checkin?.checked_in_at||""),[p,H]=a.useState(t.cancellation?.cancelled_at||""),[B,U]=a.useState(t.cancellation?.cancelled_by||"admin"),[D,X]=a.useState(t.cancellation?.reason||"");a.useEffect(()=>{v||(g(),setTimeout(()=>{b({service:"",serviceType:"",selectedDate:"",rawSelectedDate:"",selectedTime:"",fullName:"",nik:"",whatsapp:"",gender:"",birthdate:"",address:"",isWhatsappVerified:!1,isNikChecked:!1}),M(!0)},0))},[t,v,g,b]);const Y=s=>{const d=s.target.value;z(Number(d)),d&&f.get(`/admin/bookings/${t.id}/edit`,{doctor_id:d},{preserveState:!1})},Z=s=>{R(s)},A=s=>s.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"."),ee=()=>{i&&(y(!0),f.put(`/admin/bookings/${t.id}/edit`,{doctor_id:i,service:l.service||t.service,type:l.serviceType||t.type,booking_date:l.rawSelectedDate||t.booking_date,start_time:l.selectedTime||t.start_time,status:x,patient_name:r,patient_nik:o,patient_phone:m,patient_birthdate:w||null,patient_address:S||null,patient_gender:_||null,patient_medical_records:C||null,payment_amount:n?parseInt(n.replace(/\D/g,""),10):null,payment_method:P,payment_note:k||null,checked_in_at:u||null,cancelled_at:p||null,cancelled_by:B,cancellation_reason:D||null},{onFinish:()=>y(!1)}))},se=[{value:"confirmed",label:"Confirmed",color:"bg-green-100 text-green-700"},{value:"checked_in",label:"Checked In",color:"bg-blue-100 text-blue-700"},{value:"cancelled",label:"Cancelled",color:"bg-red-100 text-red-700"},{value:"no_show",label:"No Show",color:"bg-gray-100 text-gray-700"}];return e.jsx("div",{className:"min-h-screen bg-[#f8fbfc] p-6",children:e.jsxs("div",{className:"mx-auto max-w-6xl",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-[#0d171c]",children:"Edit Booking"}),e.jsxs("p",{className:"text-sm text-[#49829c]",children:["Edit semua data booking #",t.code]})]}),e.jsxs("button",{onClick:()=>f.get(`/admin/bookings/${t.id}`),className:"flex items-center gap-2 rounded-lg border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-50",children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"arrow_back"}),"Kembali"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[e.jsxs("div",{className:"rounded-xl border border-[#e7f0f4] bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("span",{className:"flex size-8 items-center justify-center rounded-full bg-primary text-sm font-bold text-white",children:"1"}),e.jsx("h2",{className:"text-lg font-bold text-[#0d171c]",children:"Status Booking"})]}),e.jsx("select",{value:x,onChange:s=>O(s.target.value),className:"w-full rounded-lg border border-[#cee0e8] bg-white px-4 py-3 text-[#0d171c] focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:se.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{className:"rounded-xl border border-[#e7f0f4] bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("span",{className:"flex size-8 items-center justify-center rounded-full bg-primary text-sm font-bold text-white",children:"2"}),e.jsx("h2",{className:"text-lg font-bold text-[#0d171c]",children:"Pilih Dokter"})]}),e.jsx("select",{value:i,onChange:Y,className:"w-full rounded-lg border border-[#cee0e8] bg-white px-4 py-3 text-[#0d171c] focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:I.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),c&&e.jsxs("div",{className:"rounded-xl border border-[#e7f0f4] bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("span",{className:"flex size-8 items-center justify-center rounded-full bg-primary text-sm font-bold text-white",children:"3"}),e.jsx("h2",{className:"text-lg font-bold text-[#0d171c]",children:"Pilih Layanan"})]}),e.jsx(te,{value:j,onChange:Z,showSisipan:!0})]}),c&&j&&e.jsxs("div",{className:"rounded-xl border border-[#e7f0f4] bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("span",{className:"flex size-8 items-center justify-center rounded-full bg-primary text-sm font-bold text-white",children:"4"}),e.jsx("h2",{className:"text-lg font-bold text-[#0d171c]",children:"Pilih Tanggal & Jam"})]}),e.jsx(ae,{availableSlots:h}),e.jsx("div",{className:"mt-6 border-t border-[#e7f0f4] pt-6",children:e.jsx(le,{availableSlots:h})}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[(l.selectedDate||t.booking_date_formatted)&&e.jsxs("div",{className:"rounded-lg bg-green-50 px-3 py-2 text-green-700",children:["ðŸ“… Tanggal:"," ",l.selectedDate||t.booking_date_formatted]}),(l.selectedTime||t.start_time)&&e.jsxs("div",{className:"rounded-lg bg-blue-50 px-3 py-2 text-blue-700",children:["â° Jam:"," ",l.selectedTime||t.start_time," ","WIB"]})]})]}),e.jsxs("div",{className:"rounded-xl border border-[#e7f0f4] bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("span",{className:"flex size-8 items-center justify-center rounded-full bg-primary text-sm font-bold text-white",children:"5"}),e.jsx("h2",{className:"text-lg font-bold text-[#0d171c]",children:"Data Pasien"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Nama Lengkap*"}),e.jsx("input",{type:"text",value:r,onChange:s=>K(s.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"NIK*"}),e.jsx("input",{type:"text",value:o,onChange:s=>E(s.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 font-mono text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"No. Telepon*"}),e.jsx("input",{type:"text",value:m,onChange:s=>W(s.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"No. Rekam Medis"}),e.jsx("input",{type:"text",value:C,onChange:s=>$(s.target.value),placeholder:"Contoh: RM-001",className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 font-mono text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Tanggal Lahir"}),e.jsx("input",{type:"date",value:w,onChange:s=>L(s.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Jenis Kelamin"}),e.jsxs("select",{value:_,onChange:s=>J(s.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"male",children:"Laki-laki"}),e.jsx("option",{value:"female",children:"Perempuan"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Alamat"}),e.jsx("textarea",{value:S,onChange:s=>q(s.target.value),rows:2,className:"w-full resize-none rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary"})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-[#e7f0f4] bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("span",{className:"flex size-8 items-center justify-center rounded-full bg-emerald-500 text-sm font-bold text-white",children:"ðŸ’³"}),e.jsx("h2",{className:"text-lg font-bold text-[#0d171c]",children:"Pembayaran"}),t.payment&&e.jsx("span",{className:"rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-700",children:"Sudah Bayar"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Nominal (Rp)"}),e.jsx("input",{type:"text",value:A(n),onChange:s=>F(s.target.value.replace(/\D/g,"")),placeholder:"0",className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Metode"}),e.jsx("select",{value:P,onChange:s=>G(s.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",children:ce.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{className:"flex flex-col gap-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Catatan Pembayaran"}),e.jsx("textarea",{value:k,onChange:s=>Q(s.target.value),rows:2,placeholder:"Catatan opsional...",className:"w-full resize-none rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary"})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-[#e7f0f4] bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("span",{className:"flex size-8 items-center justify-center rounded-full bg-blue-500 text-sm font-bold text-white",children:"âœ“"}),e.jsx("h2",{className:"text-lg font-bold text-[#0d171c]",children:"Check-in"}),t.checkin&&e.jsx("span",{className:"rounded-full bg-blue-100 px-2 py-0.5 text-xs font-medium text-blue-700",children:"Sudah Check-in"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Waktu Check-in"}),e.jsx("input",{type:"datetime-local",value:u,onChange:s=>V(s.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary md:w-1/2"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Kosongkan untuk menghapus data check-in"})]})]}),e.jsxs("div",{className:"rounded-xl border border-red-200 bg-red-50/30 p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("span",{className:"flex size-8 items-center justify-center rounded-full bg-red-500 text-sm font-bold text-white",children:"âœ•"}),e.jsx("h2",{className:"text-lg font-bold text-[#0d171c]",children:"Pembatalan"}),t.cancellation&&e.jsx("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs font-medium text-red-700",children:"Dibatalkan"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Waktu Pembatalan"}),e.jsx("input",{type:"datetime-local",value:p,onChange:s=>H(s.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Dibatalkan Oleh"}),e.jsx("select",{value:B,onChange:s=>U(s.target.value),className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",children:ie.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{className:"flex flex-col gap-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Alasan Pembatalan"}),e.jsx("textarea",{value:D,onChange:s=>X(s.target.value),rows:2,placeholder:"Alasan pembatalan booking...",className:"w-full resize-none rounded-lg border border-slate-200 px-4 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary"})]})]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Kosongkan waktu pembatalan untuk menghapus data pembatalan"})]}),e.jsx("button",{onClick:ee,disabled:N||!r||!o||!m,className:"w-full rounded-lg bg-primary py-4 font-semibold text-white transition-colors hover:bg-primary-dark disabled:cursor-not-allowed disabled:opacity-50",children:N?"Menyimpan...":"Simpan Perubahan"})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-6 space-y-6",children:[e.jsxs("div",{className:"rounded-xl border border-[#e7f0f4] bg-white p-6 shadow-sm",children:[e.jsx("h3",{className:"mb-4 text-lg font-bold text-[#0d171c]",children:"Data Asli"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Kode"}),e.jsx("span",{className:"font-mono font-medium text-[#0d171c]",children:t.code})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Status"}),e.jsx("span",{className:"font-medium text-[#0d171c]",children:t.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Dokter"}),e.jsx("span",{className:"font-medium text-[#0d171c]",children:t.doctor.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Tanggal"}),e.jsx("span",{className:"font-medium text-[#0d171c]",children:t.booking_date_formatted})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Jam"}),e.jsx("span",{className:"font-medium text-[#0d171c]",children:t.start_time?`${t.start_time} WIB`:"-"})]}),t.patient.medical_records&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"No. RM"}),e.jsx("span",{className:"font-mono font-medium text-[#0d171c]",children:t.patient.medical_records})]})]})]}),e.jsxs("div",{className:"rounded-xl border-2 border-primary/30 bg-primary/5 p-6",children:[e.jsx("h3",{className:"mb-4 text-lg font-bold text-primary",children:"Perubahan"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Status"}),e.jsx("span",{className:"font-medium text-[#0d171c]",children:x})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Dokter"}),e.jsx("span",{className:"font-medium text-[#0d171c]",children:c?.name||t.doctor.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Pasien"}),e.jsx("span",{className:"font-medium text-[#0d171c]",children:r})]}),n&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Pembayaran"}),e.jsxs("span",{className:"font-medium text-green-700",children:["Rp"," ",A(n)]})]}),u&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Check-in"}),e.jsx("span",{className:"font-medium text-blue-700",children:"âœ“"})]}),p&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[#49829c]",children:"Dibatalkan"}),e.jsx("span",{className:"font-medium text-red-700",children:"âœ•"})]})]})]})]})})]})]})})}function me(t){return e.jsx(oe,{...t})}me.layout=t=>e.jsx(de,{children:e.jsx(re,{children:t})});export{me as default};
