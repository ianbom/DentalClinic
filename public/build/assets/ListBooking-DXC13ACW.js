import{j as e,r as l,d as _,L as O}from"./app-Ddfl5t9z.js";import{B as K}from"./BookingFilters-dyJtROs0.js";import{B as L}from"./BookingTable-BwO_2PFr.js";import{A as z}from"./AdminLayout-DM3a-L7e.js";import{l as Q}from"./lodash-CsymoyDF.js";import"./index-BIydFD2V.js";import"./AdminSidebar-wHxo9R0c.js";function R({currentPage:s,totalPages:o,totalItems:i,itemsPerPage:p,onPageChange:n}){if(o<=1)return null;const m=(s-1)*p+1,u=Math.min(s*p,i),h=Array.from({length:o},(a,c)=>c+1).filter(a=>a===1||a===o||Math.abs(a-s)<=1);return e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-200 px-4 py-3",children:[e.jsxs("p",{className:"text-sm text-slate-500",children:["Menampilkan ",m," - ",u," dari ",i," booking"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>n(Math.max(1,s-1)),disabled:s===1,className:"cursor-pointer rounded-lg border border-slate-200 px-3 py-1.5 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:"Prev"}),h.map((a,c,x)=>e.jsxs("span",{children:[c>0&&x[c-1]!==a-1&&e.jsx("span",{className:"px-2 text-slate-400",children:"..."}),e.jsx("button",{onClick:()=>n(a),className:`cursor-pointer rounded-lg px-3 py-1.5 text-sm font-medium transition-colors ${s===a?"bg-primary text-white":"border border-slate-200 text-slate-600 hover:bg-slate-50"}`,children:a})]},a)),e.jsx("button",{onClick:()=>n(Math.min(o,s+1)),disabled:s===o,className:"cursor-pointer rounded-lg border border-slate-200 px-3 py-1.5 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:"Next"})]})]})}const q=[{value:"cash",label:"Tunai"},{value:"transfer",label:"Transfer Bank"},{value:"qris",label:"QRIS"},{value:"debit",label:"Kartu Debit"},{value:"credit",label:"Kartu Kredit"}];function $({isOpen:s,onClose:o,bookingId:i,bookingCode:p,existingPayment:n}){const[m,u]=l.useState(""),[h,a]=l.useState("cash"),[c,x]=l.useState(""),[b,v]=l.useState(!1);l.useEffect(()=>{n?(u(j(String(n.amount))),a(n.payment_method),x(n.note||"")):(u(""),a("cash"),x(""))},[n,s]);const f=r=>{r.preventDefault(),!(!m||b)&&(v(!0),_.post(`/admin/bookings/${i}/payment`,{amount:parseInt(m.replace(/\D/g,""),10),payment_method:h,note:c},{onSuccess:()=>{o()},onFinish:()=>v(!1)}))},j=r=>r.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"."),y=r=>{u(j(r.target.value))};if(!s)return null;const g=!!n;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:o}),e.jsxs("div",{className:"relative z-10 w-full max-w-md rounded-xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:g?"Edit Pembayaran":"Input Pembayaran"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Booking: ",p]})]}),e.jsx("button",{onClick:o,className:"rounded-lg p-1 text-slate-400 transition-colors hover:bg-slate-100 hover:text-slate-600",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),g&&e.jsx("div",{className:"mb-4 rounded-lg border border-green-200 bg-green-50 p-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"check_circle"}),e.jsx("span",{className:"text-sm font-medium",children:"Pembayaran sudah tercatat"})]})}),e.jsxs("form",{onSubmit:f,className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Nominal*"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500",children:"Rp"}),e.jsx("input",{type:"text",value:m,onChange:y,placeholder:"0",className:"w-full rounded-lg border border-slate-200 py-2.5 pl-10 pr-4 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Metode Pembayaran*"}),e.jsx("select",{value:h,onChange:r=>a(r.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",children:q.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Catatan"}),e.jsx("textarea",{value:c,onChange:r=>x(r.target.value),placeholder:"Catatan pembayaran (opsional)",rows:3,className:"w-full resize-none rounded-lg border border-slate-200 px-3 py-2.5 text-slate-900 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary"})]}),e.jsxs("div",{className:"mt-2 flex gap-3",children:[e.jsx("button",{type:"button",onClick:o,className:"flex-1 rounded-lg border border-slate-200 px-4 py-2.5 text-sm font-medium text-slate-700 transition-colors hover:bg-slate-50",children:"Batal"}),e.jsx("button",{type:"submit",disabled:!m||b,className:"flex flex-1 items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2.5 text-sm font-medium text-white transition-colors hover:bg-primary-dark disabled:cursor-not-allowed disabled:opacity-50",children:b?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-symbols-outlined animate-spin text-[18px]",children:"progress_activity"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"payments"}),g?"Update Pembayaran":"Simpan Pembayaran"]})})]})]})]})]})}function U({bookings:s,doctors:o,filters:i}){const[p,n]=l.useState(i.search||""),[m,u]=l.useState(i.status||""),[h,a]=l.useState(i.date||""),[c,x]=l.useState(i.doctor||""),[b,v]=l.useState(Number(i.per_page)||10),[f,j]=l.useState(i.sort_field||""),[y,g]=l.useState(i.sort_order||"asc"),[r,w]=l.useState(!1),[S,B]=l.useState(null),F=l.useCallback(Q.debounce(t=>{N({search:t,page:1})},500),[]),N=t=>{_.get("/admin/bookings",{search:p,status:m,date:h,doctor:c,per_page:b,sort_field:f,sort_order:y,page:s.current_page,...t},{preserveState:!0,preserveScroll:!0,replace:!0})},M=t=>{n(t),F(t)},C=(t,d)=>{let k={};t==="status"?(u(d),k={status:d,page:1}):t==="date"?(a(d),k={date:d,page:1}):t==="doctor"&&(x(d),k={doctor:d,page:1}),N(k)},P=()=>{n(""),u(""),a(""),x(""),j(""),g("asc"),_.get("/admin/bookings")},D=t=>{v(t),N({per_page:t,page:1})},I=t=>{N({page:t})},E=t=>{let d="asc";f===t&&(d=y==="asc"?"desc":"asc"),j(t),g(d),N({sort_field:t,sort_order:d})},A=t=>{B(t),w(!0)},T=()=>{w(!1),B(null)};return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight text-slate-900",children:"Daftar Booking"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Kelola todos data booking pasien"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"rounded-full bg-primary/10 px-4 py-1.5 text-sm font-medium text-primary",children:["Total: ",s.total," booking"]}),e.jsxs(O,{href:"/admin/bookings/create",className:"flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-primary-dark",children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"add"}),"Buat Booking"]})]})]}),e.jsx(K,{searchQuery:p,statusFilter:m,dateFilter:h,doctorFilter:c,doctors:o,onSearchChange:M,onStatusChange:t=>C("status",t),onDateChange:t=>C("date",t),onDoctorChange:t=>C("doctor",t),onClearFilters:P}),e.jsx(L,{bookings:s.data,showExpandable:!0,showActions:!0,currentPage:s.current_page,itemsPerPage:s.per_page,emptyMessage:"Tidak ada booking ditemukan",sortField:f,sortOrder:y,onSort:E,onPayment:A}),e.jsxs("div",{className:"flex flex-col items-center justify-between gap-4 sm:flex-row",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Tampilkan:"}),e.jsxs("select",{value:b,onChange:t=>D(Number(t.target.value)),className:"rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:1e3,children:"1000"}),e.jsx("option",{value:1e4,children:"10000"})]}),e.jsx("span",{className:"text-sm text-slate-500",children:"data"})]}),e.jsx(R,{currentPage:s.current_page,totalPages:s.last_page,totalItems:s.total,itemsPerPage:s.per_page,onPageChange:I})]}),S&&e.jsx($,{isOpen:r,onClose:T,bookingId:S.id,bookingCode:S.code,existingPayment:S.payment})]})}U.layout=s=>e.jsx(z,{children:s});export{U as default};
