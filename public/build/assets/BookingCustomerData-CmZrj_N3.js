import{j as e,r as m,L as u,d as f}from"./app-BIRp2Rbv.js";import{B as N}from"./BookingHeader-Cy4WgxJO.js";import{u as b,B as v}from"./BookingContext-CM2TI5VD.js";import{P as w}from"./PatientLayout-sQP7mc_w.js";import"./Navbar-yH9ng6JF.js";function C({doctor:s}){const{bookingData:t}=b();return e.jsxs("div",{className:"sticky top-24 flex cursor-default flex-col gap-6 rounded-xl border border-gray-100 bg-white p-6 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between border-b border-gray-100 pb-4",children:e.jsx("h3",{className:"text-lg font-bold text-text-light",children:"Ringkasan Booking"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"relative size-16 shrink-0 overflow-hidden rounded-full bg-gray-100",children:e.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url("${s?.profile_pic||"/img/default-doctor.png"}")`}})}),e.jsx("div",{className:"flex flex-col justify-center",children:e.jsx("p",{className:"font-bold text-text-light",children:s?.name||"Loading..."})})]}),e.jsxs("div",{className:"flex flex-col gap-4 rounded-lg bg-background-light p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"material-symbols-outlined mt-0.5 text-[20px] text-primary",children:"calendar_month"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-text-light",children:t.selectedDate}),e.jsx("p",{className:"text-xs text-gray-500",children:t.selectedTime})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"material-symbols-outlined mt-0.5 text-[20px] text-primary",children:"location_on"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-text-light",children:"Cantika Dental Care"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Dandong, Kec. Srengat, Kabupaten Blitar"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"material-symbols-outlined mt-0.5 text-[20px] text-primary",children:"medical_services"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-text-light",children:t.service||"Pilih Layanan"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Durasi:"," ",t.serviceType==="long"?"45 Menit":t.serviceType==="short"?"15 Menit":"-"]})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-gray-400",children:[e.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"lock"}),e.jsx("p",{className:"text-xs font-medium",children:"Data Anda aman dan terenkripsi."})]})]})}function K({doctorId:s}){const{bookingData:t,setBookingData:o}=b(),[d,p]=m.useState(!1),[c,h]=m.useState(!1),[g,x]=m.useState(""),[r,l]=m.useState(null),n=(a,i)=>{o({[a]:i}),a==="whatsapp"&&x(""),a==="nik"&&(o({isNikChecked:!1}),l(null))},k=()=>{if(!t.nik||t.nik.length<16){l({type:"error",text:"NIK harus 16 digit"});return}h(!0),l(null),f.post("/check-nik",{nik:t.nik},{preserveState:!0,preserveScroll:!0,onSuccess:a=>{const i=a.props.flash;i?.nikCheck?.found&&i.nikCheck.patient?(o({fullName:i.nikCheck.patient.patient_name||"",email:i.nikCheck.patient.patient_email||"",whatsapp:i.nikCheck.patient.patient_phone||"",birthdate:i.nikCheck.patient.patient_birthdate||"",address:i.nikCheck.patient.patient_address||"",isNikChecked:!0}),l({type:"success",text:"Data ditemukan! Form telah terisi otomatis."})):(o({isNikChecked:!0}),l({type:"info",text:"NIK belum terdaftar. Silakan isi data lengkap."})),h(!1)},onError:()=>{l({type:"error",text:"Gagal memeriksa NIK. Coba lagi."}),h(!1)}})},y=()=>{if(!t.whatsapp||t.whatsapp.length<10){x("Masukkan nomor WhatsApp yang valid");return}p(!0),x(""),f.post("/verify-wa",{patient_phone:t.whatsapp},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{o({isWhatsappVerified:!0}),p(!1)},onError:()=>{x("Gagal mengirim pesan verifikasi. Coba lagi."),p(!1)}})},j=t.fullName.trim()!==""&&t.nik.trim()!==""&&t.nik.length>=16&&t.whatsapp.trim()!==""&&t.whatsapp.length>=10&&t.birthdate.trim()!==""&&t.address.trim()!==""&&t.isWhatsappVerified&&t.isNikChecked;return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2 border-b border-subtle-light pb-6",children:[e.jsx("h1",{className:"text-3xl font-bold leading-tight text-text-light",children:"Isi Data Diri"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Pastikan nomor WhatsApp aktif untuk verifikasi pesanan dan notifikasi jadwal."})]}),e.jsxs("form",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-light",htmlFor:"nik",children:"NIK (Nomor Induk Kependudukan)*"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:`flex h-12 flex-1 rounded-lg border bg-white px-4 py-3 text-base text-text-light transition-shadow placeholder:text-gray-400 focus:outline-none focus:ring-1 ${r?.type==="success"?"border-green-300 focus:border-green-400 focus:ring-green-400":r?.type==="error"?"border-red-300 focus:border-red-400 focus:ring-red-400":"border-gray-200 focus:border-primary focus:ring-primary"}`,id:"nik",placeholder:"Masukkan 16 digit NIK Anda",type:"text",maxLength:16,required:!0,value:t.nik,onChange:a=>n("nik",a.target.value.replace(/\D/g,""))}),e.jsxs("button",{type:"button",onClick:k,disabled:c||t.nik.length<16,className:`flex h-12 items-center justify-center gap-2 whitespace-nowrap rounded-lg px-4 text-sm font-medium transition-all ${c||t.nik.length<16?"cursor-not-allowed bg-gray-200 text-gray-400":t.isNikChecked?"cursor-pointer bg-green-100 text-green-700":"cursor-pointer bg-primary text-white hover:bg-primary-dark"}`,children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:c?"hourglass_empty":t.isNikChecked?"check_circle":"search"}),c?"Memeriksa...":t.isNikChecked?"Terverifikasi":"Cek NIK"]})]}),r&&e.jsx("div",{className:`mt-2 rounded-lg border p-3 text-sm ${r.type==="success"?"border-green-200 bg-green-50 text-green-700":r.type==="info"?"border-blue-200 bg-blue-50 text-blue-700":"border-red-200 bg-red-50 text-red-700"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:r.type==="success"?"check_circle":r.type==="info"?"info":"error"}),e.jsx("p",{children:r.text})]})}),!t.isNikChecked&&!r&&e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:'Klik tombol "Cek NIK" untuk memverifikasi dan melihat apakah data Anda sudah terdaftar.'})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-light",htmlFor:"fullname",children:"Nama Lengkap*"}),e.jsx("input",{className:"flex h-12 w-full rounded-lg border border-gray-200 bg-white px-4 py-3 text-base text-text-light transition-shadow placeholder:text-gray-400 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",id:"fullname",placeholder:"Masukkan nama lengkap Anda sesuai KTP",type:"text",required:!0,value:t.fullName,onChange:a=>n("fullName",a.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-light",htmlFor:"birthdate",children:"Tanggal Lahir*"}),e.jsx("input",{className:"flex h-12 w-full rounded-lg border border-gray-200 bg-white px-4 py-3 text-base text-text-light transition-shadow placeholder:text-gray-400 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",id:"birthdate",type:"date",required:!0,value:t.birthdate,onChange:a=>n("birthdate",a.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"text-sm font-medium text-text-light",htmlFor:"email",children:["Email"," ",e.jsx("span",{className:"font-normal text-gray-400",children:"(Opsional)"})]}),e.jsx("input",{className:"flex h-12 w-full rounded-lg border border-gray-200 bg-white px-4 py-3 text-base text-text-light transition-shadow placeholder:text-gray-400 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",id:"email",placeholder:"contoh@email.com",type:"email",value:t.email,onChange:a=>n("email",a.target.value)})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-light",htmlFor:"address",children:"Alamat Lengkap*"}),e.jsx("textarea",{className:"flex w-full resize-none rounded-lg border border-gray-200 bg-white px-4 py-3 text-base text-text-light placeholder:text-gray-400 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",id:"address",placeholder:"Masukkan alamat lengkap sesuai KTP",rows:3,required:!0,value:t.address,onChange:a=>n("address",a.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-light",htmlFor:"whatsapp",children:"Nomor WhatsApp*"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"ðŸ“ž"}),e.jsx("div",{className:"ml-2 h-4 w-px bg-gray-300"})]}),e.jsx("input",{className:`flex h-12 w-full rounded-lg border bg-white py-3 pl-[70px] pr-4 text-base text-text-light transition-shadow placeholder:text-gray-400 focus:outline-none focus:ring-1 ${t.isWhatsappVerified?"border-green-300 focus:border-green-400 focus:ring-green-400":"border-gray-200 focus:border-primary focus:ring-primary"}`,id:"whatsapp",placeholder:"0812-3456-7890",type:"tel",required:!0,value:t.whatsapp,onChange:a=>n("whatsapp",a.target.value)}),t.isWhatsappVerified&&e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-4",children:e.jsx("span",{className:"material-symbols-outlined text-green-500",children:"verified"})})]}),!t.isWhatsappVerified&&e.jsxs("button",{type:"button",onClick:y,disabled:d||!t.whatsapp||t.whatsapp.length<10,className:`mt-2 flex items-center justify-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-all ${d||!t.whatsapp||t.whatsapp.length<10?"cursor-not-allowed bg-gray-200 text-gray-400":"cursor-pointer bg-green-100 text-green-700 hover:bg-green-200"}`,children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:d?"hourglass_empty":"send"}),d?"Mengirim...":"Kirim Verifikasi WhatsApp"]}),t.isWhatsappVerified&&e.jsx("div",{className:"mt-2 rounded-lg border border-green-200 bg-green-50 p-3 text-sm text-green-700",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"check_circle"}),e.jsx("p",{children:"Nomor WhatsApp telah terverifikasi. Anda dapat melanjutkan proses booking."})]})}),g&&e.jsx("div",{className:"mt-2 rounded-lg border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"error"}),e.jsx("p",{children:g})]})}),!t.isWhatsappVerified&&e.jsx("p",{className:"mt-1 text-xs text-gray-400",children:"Klik tombol di atas untuk memverifikasi nomor WhatsApp Anda sebelum melanjutkan."})]}),(!t.isWhatsappVerified||!t.isNikChecked)&&e.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4 text-sm text-amber-700",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"warning"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Verifikasi diperlukan:"}),!t.isNikChecked&&' Klik "Cek NIK" untuk memverifikasi NIK Anda.',!t.isWhatsappVerified&&" Verifikasi nomor WhatsApp sebelum melanjutkan."]})]})}),e.jsxs("div",{className:"mt-4 flex flex-col justify-end gap-3 border-t border-subtle-light pt-4 sm:flex-row",children:[e.jsxs(u,{href:`/doctors/${s}/booking`,className:"flex w-full cursor-pointer items-center justify-center gap-2 rounded-lg border border-gray-300 px-6 py-3 font-semibold text-gray-700 transition-all hover:bg-gray-50 md:w-auto",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"arrow_back"}),e.jsx("span",{children:"Kembali"})]}),j?e.jsxs(u,{href:`/doctors/${s}/booking/patient-data/review`,className:"flex w-full cursor-pointer items-center justify-center gap-2 rounded-lg bg-primary px-8 py-3 font-bold text-white transition-all hover:bg-primary-dark focus:ring-4 focus:ring-primary/20 md:w-auto",children:[e.jsx("span",{children:"Lanjut ke Review"}),e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"arrow_forward"})]}):e.jsxs("button",{type:"button",disabled:!0,className:"flex w-full cursor-not-allowed items-center justify-center gap-2 rounded-lg bg-gray-300 px-8 py-3 font-bold text-gray-500 md:w-auto",children:[e.jsx("span",{children:"Lanjut ke Review"}),e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"arrow_forward"})]})]})]})]})}function _({doctor:s}){return e.jsx("div",{className:"flex min-h-screen flex-1 flex-col items-center bg-background-light px-4 py-8 font-display md:px-10 lg:px-20",children:e.jsxs("div",{className:"flex w-full max-w-6xl flex-col gap-8",children:[e.jsx(N,{currentStep:2}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-12",children:[e.jsx("div",{className:"lg:col-span-8",children:e.jsx(K,{doctorId:String(s.id)})}),e.jsx("div",{className:"lg:col-span-4",children:e.jsx(C,{doctor:s})})]})]})})}_.layout=s=>e.jsx(w,{children:e.jsx(v,{children:s})});export{_ as default};
