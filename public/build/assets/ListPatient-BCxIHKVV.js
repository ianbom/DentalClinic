import{j as e,L as j,d as u,r as m}from"./app-Ddfl5t9z.js";import{A as C}from"./AdminLayout-DM3a-L7e.js";import{l as S}from"./lodash-CsymoyDF.js";import"./AdminSidebar-wHxo9R0c.js";function P({searchQuery:s,onSearchChange:a,genderFilter:n,onGenderChange:x,onClearFilters:i}){return e.jsx("div",{className:"rounded-t-xl border-b border-slate-100 bg-white p-5",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"relative w-full md:max-w-md",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"search"})}),e.jsx("input",{className:"block w-full rounded-lg border-none bg-slate-50 py-2.5 pl-10 pr-3 text-sm text-slate-900 transition-all placeholder:text-slate-400 focus:bg-white focus:ring-2 focus:ring-primary",placeholder:"Cari Nama, NIK, atau WhatsApp...",type:"text",value:s,onChange:r=>a(r.target.value)})]}),e.jsxs("div",{className:"flex w-full flex-col gap-3 md:w-auto md:flex-row md:items-center",children:[e.jsxs("select",{value:n,onChange:r=>x(r.target.value),className:"rounded-lg border-none bg-slate-50 py-2.5 pl-3 pr-8 text-sm text-slate-700 transition-all focus:bg-white focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Semua Gender"}),e.jsx("option",{value:"male",children:"Laki-laki"}),e.jsx("option",{value:"female",children:"Perempuan"})]}),(s||n)&&e.jsxs("button",{onClick:i,className:"flex items-center gap-1 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm font-medium text-red-500 hover:text-red-700",children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"close"}),"Reset"]})]})]})})}function I({totalPatients:s}){const a=()=>{sessionStorage.removeItem("bookingData"),u.visit("/admin/patients/create")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(j,{href:"/admin",className:"font-medium text-slate-500 transition-colors hover:text-primary",children:"Dashboard"}),e.jsx("span",{className:"select-none text-slate-400",children:"/"}),e.jsx("span",{className:"font-medium text-slate-900",children:"Pasien"})]}),e.jsxs("div",{className:"flex flex-col justify-between gap-4 sm:flex-row sm:items-end",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h2",{className:"text-3xl font-black tracking-tight text-slate-900 md:text-3xl",children:"Daftar Pasien"}),e.jsxs("p",{className:"text-base text-slate-500",children:["Kelola data pasien, riwayat, dan detail kontak."," ",e.jsxs("span",{className:"font-medium text-primary",children:["Total: ",s," pasien"]})]})]}),e.jsxs("button",{onClick:a,className:"flex h-10 shrink-0 items-center justify-center gap-2 rounded-lg bg-primary px-6 text-sm font-bold text-white shadow-sm transition-all hover:bg-sky-600 active:scale-95",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"add"}),e.jsx("span",{children:"Tambah Pasien"})]})]})]})}function L({currentPage:s,totalPages:a,totalItems:n,itemsPerPage:x,setCurrentPage:i}){if(a<=1)return null;const r=(s-1)*x+1,d=Math.min(s*x,n);return e.jsxs("div",{className:"flex flex-col items-center justify-between gap-4 rounded-b-xl border-t border-slate-100 bg-white p-4 sm:flex-row",children:[e.jsxs("span",{className:"text-sm text-slate-500",children:["Menampilkan"," ",e.jsx("span",{className:"font-semibold text-slate-700",children:r})," ","-"," ",e.jsx("span",{className:"font-semibold text-slate-700",children:d})," ","dari"," ",e.jsx("span",{className:"font-semibold text-slate-700",children:n})," ","pasien"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>i(Math.max(1,s-1)),disabled:s===1,className:"rounded-lg border border-slate-200 p-2 text-slate-500 transition-colors hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"chevron_left"})}),Array.from({length:Math.min(5,a)},(l,c)=>{let o=c+1;return a>5&&(s<=3?o=c+1:s>=a-2?o=a-4+c:o=s-2+c),e.jsx("button",{onClick:()=>i(o),className:`flex size-8 items-center justify-center rounded-lg text-sm font-medium transition-all ${s===o?"bg-primary text-white shadow-sm":"text-slate-600 hover:bg-slate-50"}`,children:o},o)}),e.jsx("button",{onClick:()=>i(Math.min(a,s+1)),disabled:s===a,className:"rounded-lg border border-slate-200 p-2 text-slate-500 transition-colors hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-50",children:e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"chevron_right"})})]})]})}function A({patients:s,currentPage:a,itemsPerPage:n,sortField:x,sortOrder:i,onSort:r}){const d=({field:l})=>x!==l?e.jsx("span",{className:"material-symbols-outlined text-[16px] text-slate-300",children:"unfold_more"}):e.jsx("span",{className:"material-symbols-outlined text-[16px] text-primary",children:i==="asc"?"arrow_upward":"arrow_downward"});return e.jsx("div",{className:"w-full overflow-x-auto bg-white",children:s.length>0?e.jsxs("table",{className:"w-full border-collapse text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-100 bg-slate-50",children:[e.jsx("th",{className:"w-16 p-4 text-center text-xs font-semibold uppercase tracking-wide text-slate-500",children:"No"}),e.jsx("th",{className:"min-w-[150px] cursor-pointer p-4 text-xs font-semibold uppercase tracking-wide text-slate-500 hover:text-primary",onClick:()=>r("medical_records"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["No RM",e.jsx(d,{field:"medical_records"})]})}),e.jsx("th",{className:"min-w-[200px] cursor-pointer p-4 text-xs font-semibold uppercase tracking-wide text-slate-500 hover:text-primary",onClick:()=>r("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Nama Pasien",e.jsx(d,{field:"name"})]})}),e.jsx("th",{className:"min-w-[100px] p-4 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Gender"}),e.jsx("th",{className:"min-w-[150px] p-4 text-xs font-semibold uppercase tracking-wide text-slate-500",children:"No WhatsApp"}),e.jsx("th",{className:"min-w-[140px] cursor-pointer p-4 text-center text-xs font-semibold uppercase tracking-wide text-slate-500 hover:text-primary",onClick:()=>r("total_visits"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Kunjungan",e.jsx(d,{field:"total_visits"})]})}),e.jsx("th",{className:"cursor-pointer p-4 text-xs font-semibold uppercase tracking-wide text-slate-500 hover:text-primary",onClick:()=>r("created_at"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Daftar pada",e.jsx(d,{field:"created_at"})]})}),e.jsx("th",{className:"w-24 p-4 text-right text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:s.map((l,c)=>e.jsxs("tr",{className:"group transition-colors hover:bg-slate-50",children:[e.jsx("td",{className:"p-4 text-center text-sm text-slate-400",children:(a-1)*n+c+1}),e.jsx("td",{className:"p-4 font-mono text-sm font-medium text-slate-600",children:l.medical_records||"-"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:l.name}),e.jsxs("span",{className:"text-xs text-slate-500",children:["NIK: ",l.nik]})]})}),e.jsx("td",{className:"p-4 text-sm text-slate-600",children:l.gender==="male"?"Laki-laki":"Perempuan"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"flex size-6 items-center justify-center rounded-md bg-green-50 text-green-500",children:e.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"chat"})}),e.jsx("span",{className:"font-mono text-sm text-slate-600",children:l.phone})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsxs("span",{className:"inline-flex items-center rounded-full bg-primary/10 px-2.5 py-0.5 text-xs font-medium text-primary",children:[l.total_visits," Kali"]})}),e.jsx("td",{className:"p-4 text-sm text-slate-500",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:l.created_at_formatted}),e.jsx("span",{className:"text-xs text-slate-400",children:l.created_at.split(" ")[1]})]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx(j,{href:`/admin/patients/${l.id}`,className:"cursor-pointer rounded-md bg-primary p-1.5 text-white transition-colors hover:bg-sky-600",title:"Lihat Detail",children:e.jsx("span",{className:"material-symbols-outlined text-lg",children:"visibility"})})})})]},l.id))})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl text-slate-300",children:"person_search"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500",children:"Tidak ada pasien ditemukan"})]})})}function F({patients:s,filters:a}){const[n,x]=m.useState(a.search||""),[i,r]=m.useState(a.gender||""),[d,l]=m.useState(a.sort_field||"created_at"),[c,o]=m.useState(a.sort_order||"desc"),[f,g]=m.useState(Number(a.per_page)||10),p=t=>{u.get("/admin/patients",{search:n,gender:i,per_page:f,sort_field:d,sort_order:c,page:s.current_page,...t},{preserveState:!0,preserveScroll:!0,replace:!0})},b=m.useCallback(S.debounce(t=>{p({search:t,page:1})},500),[]),N=t=>{x(t),b(t)},v=t=>{r(t),p({gender:t,page:1})},y=t=>{let h="asc";d===t&&(h=c==="asc"?"desc":"asc"),l(t),o(h),p({sort_field:t,sort_order:h})},w=t=>{p({page:t})},k=t=>{g(t),p({per_page:t,page:1})},_=()=>{x(""),r(""),l("created_at"),o("desc"),u.get("/admin/patients")};return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(I,{totalPatients:s.total}),e.jsxs("div",{className:"flex flex-col rounded-xl shadow-sm",children:[e.jsx(P,{searchQuery:n,onSearchChange:N,genderFilter:i,onGenderChange:v,onClearFilters:_}),e.jsx(A,{patients:s.data,currentPage:s.current_page,itemsPerPage:s.per_page,sortField:d,sortOrder:c,onSort:y}),e.jsxs("div",{className:"flex flex-col items-center justify-between gap-4 border-t border-slate-100 bg-white px-4 py-3 sm:flex-row",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Tampilkan:"}),e.jsxs("select",{value:f,onChange:t=>k(Number(t.target.value)),className:"rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("span",{className:"text-sm text-slate-500",children:"data"})]}),e.jsx(L,{currentPage:s.current_page,totalPages:s.last_page,totalItems:s.total,itemsPerPage:s.per_page,setCurrentPage:w})]})]})]})}F.layout=s=>e.jsx(C,{children:s});export{F as default};
