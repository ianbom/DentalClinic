import{j as e,L as m,r as p,d as h}from"./app-Ddfl5t9z.js";import{A as g}from"./AdminLayout-DM3a-L7e.js";import{g as N}from"./index-BIydFD2V.js";import"./AdminSidebar-wHxo9R0c.js";function y(){return e.jsxs("div",{className:"mb-8",children:[e.jsxs("nav",{className:"mb-3 flex items-center text-sm font-medium text-slate-500",children:[e.jsxs(m,{href:"/admin/bookings",className:"flex items-center gap-1 transition-colors hover:text-primary",children:[e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"arrow_back"}),"Kembali"]}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx(m,{href:"/admin/bookings",className:"transition-colors hover:text-primary",children:"Daftar Booking"}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("span",{className:"text-slate-900",children:"Detail Booking"})]}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:"Detail Booking"})]})}function v({doctorName:s,doctorSpeciality:n,doctorImage:r,date:l,time:a}){return e.jsxs("div",{className:"overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 bg-slate-50/50 px-6 py-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Detail Jadwal"}),e.jsx("button",{className:"text-sm font-medium text-primary hover:underline",children:"Ubah Jadwal"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col gap-6 sm:flex-row",children:[e.jsxs("div",{className:"flex min-w-[200px] items-center gap-4",children:[e.jsx("div",{className:"size-16 rounded-full border-2 border-slate-100 bg-slate-200 bg-cover bg-center",style:{backgroundImage:`url("${r}")`}}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-0.5 text-xs font-semibold uppercase tracking-wider text-slate-500",children:"Dokter"}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:s}),e.jsx("p",{className:"text-sm text-slate-500",children:n})]})]}),e.jsx("div",{className:"hidden w-px bg-slate-200 sm:block"}),e.jsxs("div",{className:"flex flex-col justify-center gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2 text-primary",children:e.jsx("span",{className:"material-symbols-outlined block",children:"calendar_month"})}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-0.5 text-xs font-semibold uppercase tracking-wider text-slate-500",children:"Tanggal"}),e.jsx("p",{className:"font-bold text-slate-900",children:l})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"rounded-lg bg-primary/10 p-2 text-primary",children:e.jsx("span",{className:"material-symbols-outlined block",children:"schedule"})}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-0.5 text-xs font-semibold uppercase tracking-wider text-slate-500",children:"Waktu"}),e.jsx("p",{className:"font-bold text-slate-900",children:a})]})]})]})]})})]})}function w({bookingId:s,code:n,createdDate:r,status:l,rawStatus:a}){const[i,d]=p.useState(!1),t=a==="confirmed",c=a==="confirmed"||a==="pending",o=()=>{try{sessionStorage.removeItem("bookingData")}catch(j){console.error("Error clearing booking data:",j)}},u=()=>{i||(d(!0),h.post("/admin/checkin/perform",{code:n.replace("#","")},{onFinish:()=>d(!1)}))},b=()=>{i||confirm("Apakah Anda yakin ingin membatalkan booking ini?")&&(d(!0),h.post(`/admin/bookings/${s}/cancel`,{},{onFinish:()=>d(!1)}))},f=()=>{switch(a){case"confirmed":return"border-blue-200 bg-blue-100 text-blue-800";case"checked_in":return"border-green-200 bg-green-100 text-green-800";case"cancelled":return"border-red-200 bg-red-100 text-red-800";case"no_show":return"border-gray-200 bg-gray-100 text-gray-800";case"completed":return"border-emerald-200 bg-emerald-100 text-emerald-800";default:return"border-amber-200 bg-amber-100 text-amber-800"}};return e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsx("div",{className:"mb-6 flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center",children:e.jsxs("div",{children:[e.jsxs("div",{className:"mb-1 flex items-center gap-3",children:[e.jsxs("h2",{className:"text-2xl font-black text-slate-900",children:["#",n.replace("#","")]}),e.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold ${f()}`,children:l})]}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Dipesan pada ",r]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3 border-t border-slate-100 pt-4",children:[e.jsxs(m,{href:`/admin/bookings/${s}/edit`,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-blue-500 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-blue-600",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"edit"}),"Edit"]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:u,disabled:i,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-green-600 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-green-700 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"how_to_reg"}),i?"Processing...":"Check-in"]}),e.jsxs("button",{onClick:b,disabled:i,className:"inline-flex items-center justify-center gap-2 rounded-lg border border-red-200 bg-white px-5 py-2.5 text-sm font-semibold text-red-600 transition-colors hover:bg-red-50 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"cancel"}),"Batalkan"]})]}),c&&e.jsxs(m,{href:`/admin/bookings/${s}/reschedule`,onClick:o,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-amber-500 px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-amber-600",children:[e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"event_repeat"}),"Reschedule Booking"]}),!t&&!c&&e.jsx(e.Fragment,{})]})]})}function _({booking:s}){const n=s.status==="confirmed",r=s.status==="checked_in",l=s.status==="cancelled";return e.jsxs("div",{className:"overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-slate-100 bg-slate-50/50 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Timeline Status"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute bottom-2 left-3.5 top-2 w-0.5 bg-slate-200"}),e.jsx(x,{icon:"add_circle",title:"Booking Dibuat",time:s.created_at_formatted,status:"completed"}),e.jsx(x,{icon:l?"cancel":"check_circle",title:l?"Booking Dibatalkan":"Booking Dikonfirmasi",time:l&&s.cancellation?s.cancellation.cancelled_at:n||r?"Terkonfirmasi":void 0,description:l&&s.cancellation?`Oleh ${s.cancellation.cancelled_by}: ${s.cancellation.reason}`:void 0,status:l?"cancelled":n||r?"completed":"current"}),!l&&e.jsx(x,{icon:"how_to_reg",title:"Pasien Check-in",time:s.checkin?s.checkin.checked_in_at_formatted:void 0,status:r?"completed":n?"current":"pending"}),!l&&e.jsx(x,{icon:"flag",title:"Selesai",time:r?"Selesai":void 0,status:r?"completed":"pending",isLast:!0}),s.reschedules.length>0&&e.jsxs("div",{className:"mt-6 border-t border-slate-100 pt-6",children:[e.jsx("h4",{className:"mb-4 text-sm font-semibold text-slate-600",children:"Riwayat Reschedule"}),s.reschedules.map(a=>e.jsx(x,{icon:"schedule",title:"Jadwal Diubah",time:a.created_at,description:`${a.old_date} ${a.old_time} → ${a.new_date} ${a.new_time}`,status:"completed"},a.id))]})]})})]})}function x({icon:s,title:n,time:r,description:l,status:a,isLast:i=!1}){const d=()=>{switch(a){case"completed":return"bg-green-100 ring-2 ring-green-100 text-green-600";case"current":return"bg-primary ring-4 ring-primary/20 text-white animate-pulse";case"cancelled":return"bg-red-100 ring-2 ring-red-100 text-red-600";default:return"bg-slate-100 text-slate-400"}},t=()=>{switch(a){case"current":return"text-primary";case"cancelled":return"text-red-600";default:return"text-slate-900"}};return e.jsxs("div",{className:`relative flex items-start gap-4 ${i?"":"mb-8"} ${a==="pending"?"opacity-50":""}`,children:[e.jsx("div",{className:`relative z-10 flex size-8 items-center justify-center rounded-full border-2 border-white ${d()}`,children:e.jsx("span",{className:"material-symbols-outlined text-[16px] font-bold",children:a==="completed"&&s!=="schedule"?"check":s})}),e.jsxs("div",{className:"flex-1 pt-1",children:[e.jsx("h4",{className:`text-sm font-bold ${t()}`,children:n}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:r||(a==="current"?"Proses selanjutnya":"-")}),l&&e.jsx("p",{className:"mt-1 text-xs text-slate-600",children:l})]})]})}function k({notifications:s,defaultOpen:n=!1}){const[r,l]=p.useState(n),a=t=>{const c=new Date(t);return new Intl.DateTimeFormat("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(c)},i=t=>{switch(t){case"sent":return"bg-green-100 text-green-700 border-green-200";case"failed":return"bg-red-100 text-red-700 border-red-200";case"pending":return"bg-yellow-100 text-yellow-700 border-yellow-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},d=t=>{switch(t){case"whatsapp":return"chat";case"email":return"mail";default:return"notifications"}};return e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("button",{onClick:()=>l(!r),className:"flex w-full items-center justify-between p-6 text-left transition-colors hover:bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Riwayat Notifikasi"}),e.jsx("span",{className:"rounded-full bg-slate-100 px-2 py-0.5 text-xs font-medium text-slate-600",children:s.length})]}),e.jsx("span",{className:`material-symbols-outlined text-slate-400 transition-transform duration-200 ${r?"rotate-180":""}`,children:"expand_more"})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ${r?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"}`,children:s.length===0?e.jsx("div",{className:"border-t border-slate-100 py-8 text-center text-slate-500",children:"Belum ada riwayat notifikasi"}):e.jsx("div",{className:"space-y-8 border-t border-slate-100 p-6",children:s.map(t=>e.jsxs("div",{className:"group flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`flex h-10 w-10 shrink-0 items-center justify-center rounded-full border ${t.status==="sent"?"border-blue-200 bg-blue-50 text-blue-600":"border-gray-200 bg-gray-50 text-gray-500"}`,children:e.jsx("span",{className:"material-symbols-outlined text-[20px]",children:d(t.channel)})}),e.jsx("div",{className:"my-2 h-full w-px bg-slate-200 group-last:hidden"})]}),e.jsxs("div",{className:"flex-1 space-y-3 pb-6",children:[e.jsxs("div",{className:"relative rounded-2xl rounded-tl-none border border-slate-200 bg-slate-50 p-4",children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-2 border-b border-slate-200 pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`rounded-full border px-2.5 py-0.5 text-xs font-semibold ${i(t.status)} capitalize`,children:t.status}),e.jsxs("span",{className:"text-xs font-medium uppercase tracking-wider text-slate-500",children:[t.channel," •"," ",t.type.replace("_"," ")]})]}),e.jsx("span",{className:"text-xs text-slate-400",children:a(t.created_at)})]}),e.jsx("div",{className:"whitespace-pre-wrap font-sans text-sm leading-relaxed text-slate-700",children:t.payload})]}),e.jsx("div",{className:"pl-2",children:e.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200 bg-white",children:e.jsx("table",{className:"min-w-full divide-y divide-slate-100",children:e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/4 bg-slate-50 px-4 py-2 text-xs font-medium text-slate-500",children:"Penerima"}),e.jsx("td",{className:"px-4 py-2 font-mono text-xs text-slate-700",children:t.recipient})]}),t.sent_at&&e.jsxs("tr",{children:[e.jsx("td",{className:"bg-slate-50 px-4 py-2 text-xs font-medium text-slate-500",children:"Terikirim Pada"}),e.jsx("td",{className:"px-4 py-2 text-xs text-slate-700",children:a(t.sent_at)})]}),t.last_error&&e.jsxs("tr",{children:[e.jsx("td",{className:"bg-red-50 px-4 py-2 text-xs font-medium text-red-500",children:"Error Log"}),e.jsx("td",{className:"break-all px-4 py-2 font-mono text-xs text-red-600",children:t.last_error})]})]})})})})]})]},t.id))})})]})}const D={cash:"Tunai",transfer:"Transfer Bank",qris:"QRIS",debit:"Kartu Debit",credit:"Kartu Kredit"};function $({name:s,nik:n,whatsapp:r,gender:l,birthdate:a,address:i,medicalRecords:d,service:t,payment:c}){const o=l==="male"?"Laki-laki":l==="female"?"Perempuan":"-";return e.jsxs("div",{className:"sticky top-24 space-y-6",children:[e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-slate-100 bg-slate-50/50 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Data Pasien"})}),e.jsxs("div",{className:"flex flex-col items-center border-b border-slate-100 p-6 text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:s}),e.jsx("p",{className:"text-sm text-slate-500",children:"Pasien"})]}),e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"NIK"}),e.jsx("span",{className:"font-mono text-sm font-medium text-slate-900",children:n})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"Jenis Kelamin"}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:o})]}),a&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"Tanggal Lahir"}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:a})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"Nomor WhatsApp"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-slate-900",children:r}),e.jsx("button",{className:"text-slate-400 transition-colors hover:text-primary",children:e.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"content_copy"})})]})]}),i&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"Alamat"}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:i})]}),d&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"No. Rekam Medis"}),e.jsx("span",{className:"font-mono text-sm font-medium text-slate-900",children:d})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase text-slate-500",children:"Tindakan"}),e.jsx("span",{className:"text-sm font-medium italic text-slate-900",children:t})]}),e.jsx("div",{className:"pt-2",children:e.jsxs("a",{href:"https://wa.me/"+r,target:"_blank",className:"flex w-full items-center justify-center gap-2 rounded-lg bg-[#25D366] px-4 py-3 text-sm font-bold text-white shadow-sm transition-colors hover:bg-[#20bd5a]",rel:"noreferrer",children:[e.jsx("svg",{className:"h-5 w-5 fill-current",viewBox:"0 0 448 512",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l121.7-31.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7 .9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"})}),"Hubungi via WA"]})})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-slate-100 bg-slate-50/50 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Pembayaran"})}),e.jsx("div",{className:"p-6",children:c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Nominal"}),e.jsxs("span",{className:"text-lg font-bold text-green-700",children:["Rp ",c.amount.toLocaleString("id-ID")]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Metode"}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:D[c.payment_method]||c.payment_method})]}),c.note&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm text-slate-500",children:"Catatan"}),e.jsx("span",{className:"text-sm text-slate-700",children:c.note})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-green-50 px-3 py-2",children:[e.jsx("span",{className:"material-symbols-outlined text-[18px] text-green-600",children:"check_circle"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Sudah Dibayar"})]})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2 py-4 text-center",children:[e.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-300",children:"payments"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Belum ada data pembayaran"})]})})]})]})}function C({booking:s,notifications:n}){return e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"flex flex-col gap-6 lg:col-span-2",children:[e.jsx(w,{bookingId:s.id,code:`#${s.code}`,createdDate:s.created_at_formatted,status:N(s.status),rawStatus:s.status}),e.jsx(v,{doctorName:s.doctor.name,doctorSpeciality:`SIP: ${s.doctor.sip}`,doctorImage:s.doctor.profile_pic||"/images/default-doctor.jpg",date:s.booking_date_formatted,time:`${s.start_time} WIB`}),e.jsx(_,{booking:s}),e.jsx(k,{notifications:n})]}),e.jsx("div",{className:"flex flex-col gap-6 lg:col-span-1",children:e.jsx($,{name:s.patient.name,nik:s.patient.nik,whatsapp:s.patient.phone,gender:s.patient.gender,birthdate:s.patient.birthdate_formatted,address:s.patient.address,medicalRecords:s.patient.medical_records,service:s.service,payment:s.payment})})]})]})}C.layout=s=>e.jsx(g,{children:s});export{C as default};
