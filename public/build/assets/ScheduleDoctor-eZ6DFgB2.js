import{j as e,r as S,d as L}from"./app-C3gc7qHm.js";import{A as E}from"./AdminLayout-B8kNTLjm.js";import"./AdminSidebar-BVdEzWNw.js";function G(t,l){switch(t){case"available":return e.jsx("div",{className:"rounded border border-green-200 bg-green-100 px-2 py-1",children:e.jsxs("p",{className:"truncate text-[10px] font-bold text-green-700",children:[l," Tersedia"]})});case"full":return e.jsx("div",{className:"rounded border border-red-200 bg-red-100 px-2 py-1",children:e.jsx("p",{className:"truncate text-[10px] font-bold text-red-700",children:"Penuh"})});case"off":return e.jsx("div",{className:"rounded border border-yellow-200 bg-yellow-100 px-2 py-1",children:e.jsx("p",{className:"truncate text-[10px] font-bold text-yellow-700",children:"Cuti/Tidak Aktif"})});default:return e.jsx("div",{className:"rounded border border-gray-200 bg-gray-100 px-2 py-1",children:e.jsx("p",{className:"truncate text-[10px] font-bold text-gray-500",children:"Tidak Ada Jadwal"})})}}function W({days:t,onSelectDate:l}){const d=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];return e.jsxs("div",{className:"flex min-h-[600px] flex-1 flex-col overflow-hidden rounded-xl border border-[#e7f0f4] bg-white shadow-sm",children:[e.jsx("div",{className:"grid grid-cols-7 border-b border-[#e7f0f4] bg-[#f8fbfc]",children:d.map(a=>e.jsx("div",{className:"py-3 text-center text-xs font-bold uppercase tracking-wider text-[#49829c]",children:a},a))}),e.jsx("div",{className:"grid flex-1 grid-cols-7 grid-rows-5 divide-x divide-y divide-[#e7f0f4]",children:t.map((a,x)=>e.jsxs("div",{onClick:()=>a.isCurrentMonth&&l(a.date),className:`group relative min-h-[100px] p-2 transition-colors ${a.isCurrentMonth?a.isSelected?"z-10 cursor-pointer bg-primary/5 ring-2 ring-inset ring-primary":"cursor-pointer hover:bg-[#f0f7fa]":"bg-[#fcfdfe]"}`,children:[e.jsx("span",{className:`text-sm font-medium ${a.isCurrentMonth?a.isSelected?"flex size-7 items-center justify-center rounded-full bg-primary font-bold text-white shadow-sm":"text-[#0d171c] group-hover:text-primary":"text-[#9abdd0]"}`,children:a.date}),a.isCurrentMonth&&e.jsx("div",{className:"mt-2 flex flex-col gap-1",children:G(a.status,a.availableCount)})]},x))})]})}function V({currentMonth:t,currentYear:l,selectedDoctor:d,doctors:a,onDoctorChange:x,onPrevMonth:i,onNextMonth:m,onToday:n}){return e.jsxs("div",{className:"flex shrink-0 flex-col justify-between gap-4 md:flex-row md:items-end",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"mb-2 text-2xl font-bold text-[#0d171c] md:text-3xl",children:[t," ",l]}),e.jsx("p",{className:"text-sm text-[#49829c]",children:"Kelola jadwal dan lihat slot waktu dokter."})]}),e.jsxs("div",{className:"flex w-full flex-wrap items-center gap-3 md:w-auto",children:[e.jsxs("div",{className:"relative min-w-[240px]",children:[e.jsx("select",{value:d?.id||"",onChange:s=>x(s.target.value?Number(s.target.value):null),className:"w-full appearance-none rounded-lg border border-[#cee0e8] bg-white py-2.5 pl-4 pr-10 text-sm font-medium text-[#0d171c] focus:outline-none focus:ring-2 focus:ring-primary/50",children:a.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))}),e.jsx("span",{className:"material-symbols-outlined pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-[#49829c]",style:{fontSize:"20px"},children:"expand_more"})]}),e.jsxs("div",{className:"flex rounded-lg border border-[#cee0e8] bg-white p-1",children:[e.jsx("button",{onClick:i,className:"rounded-md p-1.5 text-[#0d171c] transition-colors hover:bg-[#f0f7fa]",children:e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"20px"},children:"chevron_left"})}),e.jsx("button",{onClick:n,className:"px-3 py-1.5 text-sm font-bold text-[#0d171c]",children:"Ganti Bulan"}),e.jsx("button",{onClick:m,className:"rounded-md p-1.5 text-[#0d171c] transition-colors hover:bg-[#f0f7fa]",children:e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"20px"},children:"chevron_right"})})]})]})]})}function q(){return e.jsxs("div",{className:"flex items-center gap-6 px-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"size-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm text-[#0d171c]",children:"Tersedia"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"size-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-sm text-[#0d171c]",children:"Penuh"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"size-3 rounded-full bg-yellow-500"}),e.jsx("span",{className:"text-sm text-[#0d171c]",children:"Cuti / Tidak Aktif"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"size-3 rounded-full bg-gray-300"}),e.jsx("span",{className:"text-sm text-[#0d171c]",children:"Tidak Ada Jadwal"})]})]})}function Q(t){const l=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],d=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"];return`${l[t.getDay()]}, ${t.getDate()} ${d[t.getMonth()]} ${t.getFullYear()}`}function U({selectedDate:t,totalSlots:l,availableSlots:d,bookedSlots:a,morningSlots:x,afternoonSlots:i,onClose:m,onAddSlot:n}){return t?e.jsxs("aside",{className:"z-10 flex w-full shrink-0 flex-col border-l border-[#e7f0f4] bg-white shadow-lg md:w-[360px]",children:[e.jsxs("div",{className:"flex items-start justify-between border-b border-[#e7f0f4] p-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-[#0d171c]",children:"Detail Jadwal"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary",style:{fontSize:"18px"},children:"calendar_today"}),e.jsx("p",{className:"text-sm text-[#49829c]",children:Q(t)})]})]}),e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-gray-600",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-6 overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-primary/20 bg-primary/5 p-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold uppercase tracking-wide text-primary",children:"Total Slot"}),e.jsx("span",{className:"text-2xl font-bold text-[#0d171c]",children:l})]}),e.jsx("div",{className:"h-8 w-px bg-primary/20"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold uppercase tracking-wide text-green-600",children:"Tersedia"}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:d})]}),e.jsx("div",{className:"h-8 w-px bg-primary/20"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-bold uppercase tracking-wide text-red-600",children:"Terisi"}),e.jsx("span",{className:"text-2xl font-bold text-red-600",children:a})]})]}),x.length>0&&e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("h4",{className:"mb-2 text-sm font-bold uppercase tracking-wider text-[#0d171c]",children:"Slot Pagi"}),x.map((s,h)=>e.jsx(P,{slot:s},h))]}),e.jsx("div",{className:"h-px w-full bg-[#e7f0f4]"}),i.length>0&&e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("h4",{className:"mb-2 text-sm font-bold uppercase tracking-wider text-[#0d171c]",children:"Slot Siang"}),i.map((s,h)=>e.jsx(P,{slot:s},h))]})]}),e.jsx("div",{className:"border-t border-[#e7f0f4] p-6",children:e.jsxs("button",{onClick:n,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-primary px-4 py-3 font-bold text-white transition-colors hover:bg-[#098dc9]",children:[e.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Tambah Slot Manual"]})})]}):null}function P({slot:t}){return t.status==="booked"?e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-[#e7f0f4] bg-gray-50 p-3 opacity-75",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-gray-400",children:"schedule"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-[#0d171c] line-through decoration-red-500",children:[t.time," - ",t.endTime]}),e.jsxs("p",{className:"text-xs font-medium text-red-500",children:["Booked (",t.patientName,")"]})]})]}),e.jsx("button",{className:"flex size-8 items-center justify-center rounded-full text-gray-500 hover:bg-gray-200",children:e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"18px"},children:"more_vert"})})]}):t.status==="off"?e.jsx("div",{className:"flex items-center justify-between rounded-lg border border-yellow-200 bg-yellow-50 p-3 opacity-75",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-yellow-600",children:"event_busy"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-[#0d171c]",children:[t.time," - ",t.endTime]}),e.jsx("p",{className:"text-xs font-medium text-yellow-600",children:"Cuti / Tidak Aktif"})]})]})}):t.status==="unavailable"?e.jsx("div",{className:"flex items-center justify-between rounded-lg border border-gray-200 bg-gray-50 p-3 opacity-75",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-gray-400",children:"block"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-[#0d171c]",children:[t.time," - ",t.endTime]}),e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Tidak Ada Jadwal"})]})]})}):e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-green-200 bg-green-50 p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"material-symbols-outlined text-green-600",children:"schedule"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold text-[#0d171c]",children:[t.time," - ",t.endTime]}),e.jsx("p",{className:"text-xs font-medium text-green-600",children:"Tersedia"})]})]}),e.jsx("button",{className:"rounded-md bg-green-600 px-3 py-1 text-xs font-bold text-white transition-colors hover:bg-green-700",children:"Book"})]})}function X(t){return["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"][t]}function Z(t){return["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"][t]}function ee(t,l){return t.some(d=>d.day_of_week===l&&d.is_active)}function te({doctor:t,availableSlots:l,allDoctors:d}){const[a,x]=S.useState(new Date),[i,m]=S.useState(null),n=a.getFullYear(),s=a.getMonth(),h=S.useMemo(()=>{const o=new Date(n,s,1),b=new Date(n,s+1,0).getDate(),j=o.getDay(),c=new Date,k=c.getFullYear()===n&&c.getMonth()===s,f=[],N=new Date(n,s,0).getDate();for(let r=j-1;r>=0;r--)f.push({date:N-r,isCurrentMonth:!1,isToday:!1,isSelected:!1,status:"no_schedule",availableCount:0,totalSlots:0});for(let r=1;r<=b;r++){const v=`${n}-${String(s+1).padStart(2,"0")}-${String(r).padStart(2,"0")}`,p=l[v],u=new Date(n,s,r),w=Z(u.getDay()),I=ee(t.working_periods||[],w);let g="no_schedule",C=0,M=0;p?(M=p.slots.length,C=p.slots.filter(J=>J.available).length,M===0?g="no_schedule":C===0?g="full":g="available"):I&&(g=u<new Date(new Date().setHours(0,0,0,0))?"no_schedule":"off"),f.push({date:r,isCurrentMonth:!0,isToday:k&&c.getDate()===r,isSelected:i===r,status:g,availableCount:C,totalSlots:M})}const y=42-f.length;for(let r=1;r<=y;r++)f.push({date:r,isCurrentMonth:!1,isToday:!1,isSelected:!1,status:"no_schedule",availableCount:0,totalSlots:0});return f},[n,s,i,l,t.working_periods]),T=S.useMemo(()=>{if(!i)return{morning:[],afternoon:[]};const o=`${n}-${String(s+1).padStart(2,"0")}-${String(i).padStart(2,"0")}`,D=l[o];if(!D)return{morning:[],afternoon:[]};const b=[],j=[];for(const c of D.slots){const[k,f]=c.time.split(":"),N=parseInt(k,10),y=parseInt(f,10),r=new Date;r.setHours(N,y,0,0);const v=new Date(r);v.setMinutes(y+(c.slot_type==="long"?45:15));const p=v.toTimeString().slice(0,5);let u="unavailable";c.available?u="available":c.reason==="time_off"?u="off":c.reason==="booked"?u="booked":u="unavailable";const w={time:c.time,endTime:p,status:u,patientName:c.reason==="booked"?"Terisi":void 0};N<12?b.push(w):j.push(w)}return{morning:b,afternoon:j}},[i,n,s,l]),F=()=>{x(new Date(n,s-1,1)),m(null)},O=()=>{x(new Date(n,s+1,1)),m(null)},B=()=>{const o=new Date;x(o),m(o.getDate())},K=o=>{o&&L.get(`/admin/doctors/schedule/${o}`,{},{preserveState:!1})},R=o=>{m(o)},Y=i?new Date(n,s,i):null,_=i?`${n}-${String(s+1).padStart(2,"0")}-${String(i).padStart(2,"0")}`:null,$=_?l[_]:null,z=$?.slots.length||0,A=$?.slots.filter(o=>o.available).length||0,H=z-A;return e.jsxs("div",{className:"flex h-full flex-col gap-6 bg-[#f8fbfc] md:flex-row",children:[e.jsxs("div",{className:"flex flex-1 flex-col gap-6 overflow-y-auto p-6",children:[e.jsx(V,{currentMonth:X(s),currentYear:n,selectedDoctor:t,doctors:d,onDoctorChange:K,onPrevMonth:F,onNextMonth:O,onToday:B}),e.jsx(W,{days:h,onSelectDate:R}),e.jsx(q,{})]}),i&&e.jsx(U,{selectedDate:Y,totalSlots:z,availableSlots:A,bookedSlots:H,morningSlots:T.morning,afternoonSlots:T.afternoon,onClose:()=>m(null),onAddSlot:()=>alert("Tambah slot manual")})]})}te.layout=t=>e.jsx(E,{children:t});export{te as default};
